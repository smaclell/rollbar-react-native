{"version":3,"sources":["../src/Rollbar.js"],"names":[],"mappings":"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","file":"Rollbar.js","sourcesContent":["import { Platform, NativeModules } from 'react-native';\n\nimport Rollbar from 'rollbar/src/react-native/rollbar';\n\nconst NativeClient = NativeModules.RollbarReactNative;\n\nexport class Client {\n  constructor(config) {\n    if (config instanceof Configuration) {\n      this.config = config;\n    } else {\n      this.config = new Configuration(config);\n    }\n    this.config.setPlatform(Platform.OS);\n\n    this.rollbar = new Rollbar(this.config.toJSON());\n\n    if (NativeClient) {\n      NativeClient.init(this.config.toJSON());\n      this.captureUncaughtExceptions();\n      if (this.config.captureUnhandledRejections) {\n        this.captureUnhandledRejections();\n      }\n    } else {\n      throw new Error('Rollbar: Native client not found. Did you run react-native link?');\n    }\n  }\n\n  captureUncaughtExceptions = () => {\n\t\tif (ErrorUtils) {\n      const previousHandler = ErrorUtils.getGlobalHandler();\n\n      ErrorUtils.setGlobalHandler((error, isFatal) => {\n        if (this.config.captureUncaught && this.config.shouldSend()) {\n          this.error(error, undefined, (queued) => {\n            if (previousHandler) {\n              previousHandler(error, isFatal);\n            }\n          });\n        } else if (previousHandler) {\n          previousHandler(error, isFatal);\n        }\n      });\n    }\n  }\n\n  captureUnhandledRejections = () => {\n\t\tconst tracking = require('promise/setimmediate/rejection-tracking');\n    const client = this;\n    tracking.enable({\n      allRejections: true,\n      onUnhandled: function(id, error) { client.error(error); },\n      onHandled: function() {}\n    });\n  }\n\n  log = (obj, extra, callback) => {\n\t\tif (!this.config.shouldSend()) {\n      if (callback) {\n        callback(false);\n      }\n      return;\n    }\n\n    this.rollbar.log(obj, extra, callback);\n  }\n\n  debug = (obj, extra, callback) => {\n    return this.rollbar.debug(obj, extra, callback);\n  }\n\n  info = (obj, extra, callback) => {\n    return this.rollbar.info(obj, extra, callback);\n  }\n\n  warning = (obj, extra, callback) => {\n    return this.rollbar.warning(obj, extra, callback);\n  }\n\n  error = (obj, extra, callback) => {\n    return this.rollbar.error(obj, extra, callback);\n  }\n\n  critical = (obj, extra, callback) => {\n    return this.rollbar.critical(obj, extra, callback);\n  }\n\n  setPerson = (id, name, email) => {\n    this.rollbar.setPerson({id, name, email});\n    NativeClient.setPerson({id, name, email});\n  }\n\n  clearPerson = () => {\n    this.rollbar.clearPerson();\n    NativeClient.clearPerson();\n  }\n}\n\nexport class Configuration {\n  constructor(accessToken, options) {\n    options = options || {};\n    const pkgData = require('../package.json');\n    this.version = pkgData['version'];\n    this.accessToken = accessToken;\n    this.logLevel = options.logLevel || 'debug';\n    this.reportLevel = options.reportLevel || 'warning';\n    this.endpoint = options.endpoint || 'https://api.rollbar.com/api/1/item/';\n    this.appVersion = options.appVersion || undefined;\n    this.codeBundleId = options.codeBundleId || undefined;\n    this.releaseStage = options.releaseStage || undefined;\n    this.enabledReleaseStages = options.enabledReleaseStages || undefined;\n    this.captureUncaught = options.captureUncaught !== undefined ? options.captureUncaught : true;\n    this.captureUnhandledRejections = options.captureUnhandledRejections !== undefined ? options.captureUnhandledRejections : !__DEV__;\n  }\n\n  shouldSend = () => {\n    return !this.releaseStage ||\n      !this.enabledReleaseStages ||\n      this.enabledReleaseStages.includes(this.releaseStage);\n  }\n\n  setPlatform = (platform) => {\n    if (this.platform === undefined) {\n      if (platform === 'ios' || platform === 'android') {\n        this.platform = platform;\n      } else {\n        this.platform = 'client';\n      }\n    }\n  }\n\n  toJSON = () => {\n    return {\n      accessToken: this.accessToken,\n      endpoint: this.endpoint,\n      platform: this.platform,\n      logLevel: this.logLevel,\n      reportLevel: this.reportLevel,\n      payload: {\n        codeBundleId: this.codeBundleId,\n        releaseStage: this.releaseStage,\n        enabledReleaseStages: this.enabledReleaseStages,\n        appVersion: this.appVersion\n      },\n      notifier: {\n        name: 'rollbar-react-native',\n        version: this.version\n      }\n    };\n  }\n}\n"]}